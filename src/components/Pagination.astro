---
// src/components/Pagination.astro
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// Generate page numbers to display
function generatePageNumbers(current: number, total: number): (number | "...")[] {
  if (total <= 7) {
    return Array.from({ length: total }, (_, i) => i + 1);
  }

  const pages: (number | "...")[] = [1];

  if (current > 3) {
    pages.push("...");
  }

  for (let i = Math.max(2, current - 1); i <= Math.min(current + 1, total - 1); i++) {
    pages.push(i);
  }

  if (current < total - 2) {
    pages.push("...");
  }

  if (total > 1) {
    pages.push(total);
  }

  return pages;
}

const pageNumbers = generatePageNumbers(currentPage, totalPages);

function getPageUrl(pageNum: number): string {
  if (pageNum === 1) {
    return baseUrl;
  }
  return `${baseUrl}${baseUrl.endsWith('/') ? '' : '/'}${pageNum}/`;
}
---

{totalPages > 1 && (
  <nav class="pagination" aria-label="Pagination">
    <ul class="pagination-list">
      {currentPage > 1 && (
        <li>
          <a
            href={getPageUrl(currentPage - 1)}
            class="pagination-link pagination-prev"
            aria-label="Previous page"
          >
            &larr; Previous
          </a>
        </li>
      )}

      {pageNumbers.map((pageNum) => (
        pageNum === "..." ? (
          <li class="pagination-ellipsis">
            <span>&hellip;</span>
          </li>
        ) : (
          <li>
            <a
              href={getPageUrl(pageNum)}
              class:list={["pagination-link", { "is-current": pageNum === currentPage }]}
              aria-label={`Page ${pageNum}`}
              aria-current={pageNum === currentPage ? "page" : undefined}
            >
              {pageNum}
            </a>
          </li>
        )
      ))}

      {currentPage < totalPages && (
        <li>
          <a
            href={getPageUrl(currentPage + 1)}
            class="pagination-link pagination-next"
            aria-label="Next page"
          >
            Next &rarr;
          </a>
        </li>
      )}
    </ul>
  </nav>
)}

<style>
  .pagination {
    margin: 3rem 0;
    display: flex;
    justify-content: center;
  }

  .pagination-list {
    display: flex;
    list-style: none;
    padding: 0;
    margin: 0;
    gap: 0.5rem;
    flex-wrap: wrap;
    align-items: center;
  }

  .pagination-link {
    display: inline-block;
    padding: 0.5rem 0.75rem;
    min-width: 2.5rem;
    text-align: center;
    border: 1px solid var(--color-border);
    border-radius: 4px;
    text-decoration: none;
    color: var(--color-text);
    font-family: var(--font-sans);
    font-size: 0.9rem;
    transition: all 0.2s;
  }

  .pagination-link:hover {
    background-color: var(--color-accent-bg, rgba(0, 0, 0, 0.03));
    border-color: var(--color-accent);
  }

  .pagination-link.is-current {
    background-color: var(--color-accent);
    color: white;
    border-color: var(--color-accent);
    font-weight: 600;
    cursor: default;
  }

  .pagination-link.is-current:hover {
    background-color: var(--color-accent);
  }

  .pagination-prev,
  .pagination-next {
    font-weight: 500;
  }

  .pagination-ellipsis {
    padding: 0.5rem;
    color: var(--color-text-muted);
  }

  @media (max-width: 480px) {
    .pagination-link {
      padding: 0.4rem 0.6rem;
      min-width: 2rem;
      font-size: 0.85rem;
    }

    .pagination-prev,
    .pagination-next {
      padding: 0.4rem 0.5rem;
    }
  }
</style>
